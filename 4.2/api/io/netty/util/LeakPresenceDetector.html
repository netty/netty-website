<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (25) on Mon Dec 15 15:33:56 CET 2025 -->
<title>LeakPresenceDetector (Netty API Reference (4.2.9.Final))</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-12-15">
<meta name="description" content="declaration: package: io.netty.util, class: LeakPresenceDetector">
<meta name="generator" content="javadoc/ClassWriter">
<meta name="keywords" content="io.netty.util.LeakPresenceDetector class">
<meta name="keywords" content="staticInitializer()">
<meta name="keywords" content="currentScope()">
<meta name="keywords" content="track()">
<meta name="keywords" content="trackForcibly()">
<meta name="keywords" content="isRecordEnabled()">
<meta name="keywords" content="check()">
<link rel="stylesheet" type="text/css" href="../../../resource-files/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="../../../resource-files/stylesheet.css">
<script type="text/javascript" src="../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/LeakPresenceDetector.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../search.html">Search</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">io.netty.util</a></li>
<li><a href="LeakPresenceDetector.html" class="current-selection">LeakPresenceDetector</a></li>
</ol>
<div class="nav-list-search"><input type="text" id="search-input" disabled placeholder="Search documentation (type /)" aria-label="Search in documentation" autocomplete="off" spellcheck="false"><input type="reset" id="reset-search" disabled value="Reset"></div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;<input type="text" class="filter-input" disabled placeholder="Filter contents (type .)" aria-label="Filter table of contents" autocomplete="off" spellcheck="false"><input type="reset" class="reset-filter" disabled tabindex="-1" value="Reset"></div>
<ol class="toc-list" tabindex="-1">
<li><a href="#" tabindex="0">Description</a></li>
<li><a href="#nested-class-summary" tabindex="0">Nested Class Summary</a></li>
<li><a href="#constructor-summary" tabindex="0">Constructor Summary</a></li>
<li><a href="#method-summary" tabindex="0">Method Summary</a></li>
<li><a href="#constructor-detail" tabindex="0">Constructor Details</a>
<ol class="toc-list">
<li><a href="#%3Cinit%3E(java.lang.Class)" tabindex="0">LeakPresenceDetector(Class)</a></li>
<li><a href="#%3Cinit%3E(java.lang.Class,int)" tabindex="0">LeakPresenceDetector(Class, int)</a></li>
<li><a href="#%3Cinit%3E(java.lang.Class,int,long)" tabindex="0">LeakPresenceDetector(Class, int, long)</a></li>
</ol>
</li>
<li><a href="#method-detail" tabindex="0">Method Details</a>
<ol class="toc-list">
<li><a href="#staticInitializer(java.util.function.Supplier)" tabindex="0">staticInitializer(Supplier)</a></li>
<li><a href="#currentScope()" tabindex="0">currentScope()</a></li>
<li><a href="#track(T)" tabindex="0">track(T)</a></li>
<li><a href="#trackForcibly(T)" tabindex="0">trackForcibly(T)</a></li>
<li><a href="#isRecordEnabled()" tabindex="0">isRecordEnabled()</a></li>
<li><a href="#check()" tabindex="0">check()</a></li>
</ol>
</li>
</ol>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span><img src="../../../resource-files/left.svg" alt="Hide sidebar"></button><button class="show-sidebar"><img src="../../../resource-files/right.svg" alt="Show sidebar"><span>&nbsp;Show sidebar</span></button></nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Class LeakPresenceDetector" class="title">Class LeakPresenceDetector&lt;T&gt;</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="ResourceLeakDetector.html" title="class in io.netty.util">io.netty.util.ResourceLeakDetector</a>&lt;T&gt;
<div class="inheritance">io.netty.util.LeakPresenceDetector&lt;T&gt;</div>
</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><span id="type-param-T"><code>T</code> - The resource type to detect</span></dd>
</dl>
<dl class="notes">
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="test/LeakPresenceExtension.WithTransferableScope.html" title="class in io.netty.util.test">LeakPresenceExtension.WithTransferableScope</a></code></dd>
</dl>
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">LeakPresenceDetector&lt;T&gt;</span>
<span class="extends-implements">extends <a href="ResourceLeakDetector.html" title="class in io.netty.util">ResourceLeakDetector</a>&lt;T&gt;</span></div>
<div class="block">Alternative leak detector implementation for reliable and performant detection in tests.

<h3 id="background-heading">Background</h3>
<p>
The standard <a href="ResourceLeakDetector.html" title="class in io.netty.util"><code>ResourceLeakDetector</code></a> produces no "false positives", but this comes with tradeoffs. You either
get many false negatives because only a small sample of buffers is instrumented, or you turn on paranoid detection
which carries a somewhat heavy performance cost with each allocation. Additionally, paranoid detection enables
detailed recording of buffer access operations with heavy performance impact. Avoiding false negatives is necessary
for (unit, fuzz...) testing if bugs should lead to reliable test failures, but the performance impact can be
prohibitive for some tests.

<h3 id="the-presence-detector-heading">The presence detector</h3>
<p>
The <i>leak presence detector</i> takes a different approach. It foregoes detailed tracking of allocation and
modification stack traces. In return every resource is counted, so there are no false negatives where a leak would
not be detected.
<p>
The presence detector also does not wait for an unclosed resource to be garbage collected before it's reported as
leaked. This ensures that leaks are detected promptly and can be directly associated with a particular test, but it
can lead to false positives. Tests that use the presence detector must shut down completely <i>before</i> checking
for resource leaks. There are also complications with static fields, described below.

<h3 id="resource-scopes-heading">Resource Scopes</h3>
<p>
A resource scope manages all resources of a set of threads over time. On allocation, a resource is assigned to a
scope through the <a href="#currentScope()"><code>currentScope()</code></a> method. When <a href="#check()"><code>check()</code></a> is called, or the scope is
<a href="LeakPresenceDetector.ResourceScope.html#close()"><code>closed</code></a>, all resources in that scope must have been released.
<p>
By default, there is only a single "global" scope, and when <a href="#check()"><code>check()</code></a> is called, all resources in the entire
JVM must have been released. To enable parallel test execution, it may be necessary to use separate scopes for
separate tests instead, so that one test can check for its own leaks while another test is still in progress. You
can override <a href="#currentScope()"><code>currentScope()</code></a> to implement this for your test framework.

<h3 id="static-fields-heading">Static Fields</h3>
<p>
While the presence detector requires that <i>all</i> resources be closed after a test, some resources kept in static
fields cannot be released, or there would be false positives. To avoid this, resources created inside static
initializers, specifically when the allocation stack trace contains a <code>&lt;clinit&gt;</code> method, <i>are not
tracked</i>.
<p>
Because the presence detector does not normally capture or introspect allocation stack traces, additional
cooperation is required. Any static initializer must be wrapped in a <a href="#staticInitializer(java.util.function.Supplier)"><code>staticInitializer(Supplier)</code></a> call,
which will temporarily enable stack trace introspection. For example:
<pre><code>private static final ByteBuf CRLF_BUF = LeakPresenceDetector.staticInitializer(() -&gt; unreleasableBuffer(
            directBuffer(2).writeByte(CR).writeByte(LF)).asReadOnly());
</code></pre>
<p>
Since stack traces are not captured by default, it can be difficult to tell apart a real leak from a missed static
initializer. You can temporarily turn on allocation stack trace capture using the
<code>-Dio.netty.util.LeakPresenceDetector.trackCreationStack=true</code> system property.</div>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="LeakPresenceDetector.AllocationProhibitedException.html" class="type-name-link" title="class in io.netty.util">LeakPresenceDetector.AllocationProhibitedException</a></code></div>
<div class="col-last even-row-color">
<div class="block">Special exception type to show that an allocation is prohibited at the moment, for example because the
<a href="LeakPresenceDetector.ResourceScope.html" title="class in io.netty.util"><code>LeakPresenceDetector.ResourceScope</code></a> is closed, or because the current thread cannot be associated with a particular scope.</div>
</div>
<div class="col-first odd-row-color"><code>static final class&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="LeakPresenceDetector.ResourceScope.html" class="type-name-link" title="class in io.netty.util">LeakPresenceDetector.ResourceScope</a></code></div>
<div class="col-last odd-row-color">
<div class="block">A resource scope keeps track of the resources for a particular set of threads.</div>
</div>
</div>
<div class="inherited-list">
<h3 id="nested-classes-inherited-from-class-io.netty.util.ResourceLeakDetector">Nested classes/interfaces inherited from class&nbsp;<a href="ResourceLeakDetector.html#nested-class-summary" title="class in io.netty.util">ResourceLeakDetector</a></h3>
<code><a href="ResourceLeakDetector.LeakListener.html" title="interface in io.netty.util">ResourceLeakDetector.LeakListener</a>, <a href="ResourceLeakDetector.Level.html" title="enum in io.netty.util">ResourceLeakDetector.Level</a></code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(java.lang.Class)" class="member-name-link">LeakPresenceDetector</a><wbr>(<a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&nbsp;resourceType)</code></div>
<div class="col-last even-row-color">
<div class="block">Create a new detector for the given resource type.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(java.lang.Class,int)" class="member-name-link">LeakPresenceDetector</a><wbr>(<a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&nbsp;resourceType,
 int&nbsp;samplingInterval)</code></div>
<div class="col-last odd-row-color">
<div class="block"><span class="deprecated-label">Deprecated.</span></div>
</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(java.lang.Class,int,long)" class="member-name-link">LeakPresenceDetector</a><wbr>(<a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&nbsp;resourceType,
 int&nbsp;samplingInterval,
 long&nbsp;maxActive)</code></div>
<div class="col-last even-row-color">
<div class="block">This constructor should not be used directly, it is called reflectively by <a href="ResourceLeakDetectorFactory.html" title="class in io.netty.util"><code>ResourceLeakDetectorFactory</code></a>.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#check()" class="member-name-link">check</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Check the current leak presence detector scope for open resources.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="LeakPresenceDetector.ResourceScope.html" title="class in io.netty.util">LeakPresenceDetector.ResourceScope</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#currentScope()" class="member-name-link">currentScope</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the resource scope for the current thread.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>final boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isRecordEnabled()" class="member-name-link">isRecordEnabled</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check whether <a href="ResourceLeakTracker.html#record()"><code>ResourceLeakTracker.record()</code></a> does anything for this detector.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;R&gt;&nbsp;R</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#staticInitializer(java.util.function.Supplier)" class="member-name-link">staticInitializer</a><wbr>(<a href="https://docs.oracle.com/javase/9/docs/api/java/util/function/Supplier.html" title="class or interface in java.util.function" class="external-link">Supplier</a>&lt;R&gt;&nbsp;supplier)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Wrap a static initializer so that any resources created inside the block will not be tracked.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>final <a href="ResourceLeakTracker.html" title="interface in io.netty.util">ResourceLeakTracker</a><wbr>&lt;<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#track(T)" class="member-name-link">track</a><wbr>(<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&nbsp;obj)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Creates a new <a href="ResourceLeakTracker.html" title="interface in io.netty.util"><code>ResourceLeakTracker</code></a> which is expected to be closed via
<a href="ResourceLeakTracker.html#close(T)"><code>ResourceLeakTracker.close(Object)</code></a> when the related resource is deallocated.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>final <a href="ResourceLeakTracker.html" title="interface in io.netty.util">ResourceLeakTracker</a><wbr>&lt;<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#trackForcibly(T)" class="member-name-link">trackForcibly</a><wbr>(<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&nbsp;obj)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Creates a new <a href="ResourceLeakTracker.html" title="interface in io.netty.util"><code>ResourceLeakTracker</code></a> which is expected to be closed via
<a href="ResourceLeakTracker.html#close(T)"><code>ResourceLeakTracker.close(Object)</code></a> when the related resource is deallocated.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-io.netty.util.ResourceLeakDetector">Methods inherited from class&nbsp;<a href="ResourceLeakDetector.html#method-summary" title="class in io.netty.util">ResourceLeakDetector</a></h3>
<code><a href="ResourceLeakDetector.html#addExclusions(java.lang.Class,java.lang.String...)" title="addExclusions(Class, String...)">addExclusions</a>, <a href="ResourceLeakDetector.html#getInitialHint(java.lang.String)" title="getInitialHint(String)">getInitialHint</a>, <a href="ResourceLeakDetector.html#getLevel()" title="getLevel()">getLevel</a>, <a href="ResourceLeakDetector.html#isEnabled()" title="isEnabled()">isEnabled</a>, <a href="ResourceLeakDetector.html#needReport()" title="needReport()">needReport</a>, <a href="ResourceLeakDetector.html#open(T)" title="open(T)">open</a>, <a href="ResourceLeakDetector.html#reportInstancesLeak(java.lang.String)" title="reportInstancesLeak(String)">reportInstancesLeak</a>, <a href="ResourceLeakDetector.html#reportTracedLeak(java.lang.String,java.lang.String)" title="reportTracedLeak(String, String)">reportTracedLeak</a>, <a href="ResourceLeakDetector.html#reportUntracedLeak(java.lang.String)" title="reportUntracedLeak(String)">reportUntracedLeak</a>, <a href="ResourceLeakDetector.html#setEnabled(boolean)" title="setEnabled(boolean)">setEnabled</a>, <a href="ResourceLeakDetector.html#setLeakListener(io.netty.util.ResourceLeakDetector.LeakListener)" title="setLeakListener(ResourceLeakDetector.LeakListener)">setLeakListener</a>, <a href="ResourceLeakDetector.html#setLevel(io.netty.util.ResourceLeakDetector.Level)" title="setLevel(ResourceLeakDetector.Level)">setLevel</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;<a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#method-summary" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#clone--" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#equals-java.lang.Object-" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#finalize--" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#getClass--" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#hashCode--" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#notify--" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#notifyAll--" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#toString--" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#wait--" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#wait-long-" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Object.html#wait-long-int-" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(java.lang.Class)">
<h3>LeakPresenceDetector</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">LeakPresenceDetector</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&nbsp;resourceType)</span></div>
<div class="block">Create a new detector for the given resource type.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>resourceType</code> - The resource type</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(java.lang.Class,int)">
<h3>LeakPresenceDetector</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>
</span><span class="modifiers">public</span>&nbsp;<span class="element-name">LeakPresenceDetector</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&nbsp;resourceType,
 int&nbsp;samplingInterval)</span></div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span></div>
<div class="block">This constructor should not be used directly, it is called reflectively by <a href="ResourceLeakDetectorFactory.html" title="class in io.netty.util"><code>ResourceLeakDetectorFactory</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>resourceType</code> - The resource type</dd>
<dd><code>samplingInterval</code> - Ignored</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(java.lang.Class,int,long)">
<h3>LeakPresenceDetector</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">LeakPresenceDetector</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&nbsp;resourceType,
 int&nbsp;samplingInterval,
 long&nbsp;maxActive)</span></div>
<div class="block">This constructor should not be used directly, it is called reflectively by <a href="ResourceLeakDetectorFactory.html" title="class in io.netty.util"><code>ResourceLeakDetectorFactory</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>resourceType</code> - The resource type</dd>
<dd><code>samplingInterval</code> - Ignored</dd>
<dd><code>maxActive</code> - Ignored</dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="staticInitializer(java.util.function.Supplier)">
<h3>staticInitializer</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;R&gt;</span>&nbsp;<span class="return-type">R</span>&nbsp;<span class="element-name">staticInitializer</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/9/docs/api/java/util/function/Supplier.html" title="class or interface in java.util.function" class="external-link">Supplier</a>&lt;R&gt;&nbsp;supplier)</span></div>
<div class="block">Wrap a static initializer so that any resources created inside the block will not be tracked. Example:
<pre><code>private static final ByteBuf CRLF_BUF = LeakPresenceDetector.staticInitializer(() -&gt; unreleasableBuffer(
            directBuffer(2).writeByte(CR).writeByte(LF)).asReadOnly());
</code></pre>
<p>
Note that technically, this method does not actually care what happens inside the block. Instead, it turns on
stack trace introspection at the start of the block, and turns it back off at the end. Any allocation in that
interval will be checked to see whether it is part of a static initializer, and if it is, it will not be
tracked.</div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><span id="staticInitializer(java.util.function.Supplier)-type-param-R"><code>R</code> - The supplier return type</span></dd>
<dt>Parameters:</dt>
<dd><code>supplier</code> - A code block to run</dd>
<dt>Returns:</dt>
<dd>The value returned by the <code>supplier</code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="currentScope()">
<h3>currentScope</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="LeakPresenceDetector.ResourceScope.html" title="class in io.netty.util">LeakPresenceDetector.ResourceScope</a></span>&nbsp;<span class="element-name">currentScope</span>()
                                                   throws <span class="exceptions"><a href="LeakPresenceDetector.AllocationProhibitedException.html" title="class in io.netty.util">LeakPresenceDetector.AllocationProhibitedException</a></span></div>
<div class="block">Get the resource scope for the current thread. This is used to assign resources to scopes, and it is used by
<a href="#check()"><code>check()</code></a> to tell which scope to check for open resources. By default, the global scope is returned.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The resource scope to use</dd>
<dt>Throws:</dt>
<dd><code><a href="LeakPresenceDetector.AllocationProhibitedException.html" title="class in io.netty.util">LeakPresenceDetector.AllocationProhibitedException</a></code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="track(T)">
<h3 id="track(java.lang.Object)">track</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public final</span>&nbsp;<span class="return-type"><a href="ResourceLeakTracker.html" title="interface in io.netty.util">ResourceLeakTracker</a>&lt;<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&gt;</span>&nbsp;<span class="element-name">track</span><wbr><span class="parameters">(<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&nbsp;obj)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from class:&nbsp;<code><a href="ResourceLeakDetector.html#track(T)">ResourceLeakDetector</a></code></span></div>
<div class="block">Creates a new <a href="ResourceLeakTracker.html" title="interface in io.netty.util"><code>ResourceLeakTracker</code></a> which is expected to be closed via
<a href="ResourceLeakTracker.html#close(T)"><code>ResourceLeakTracker.close(Object)</code></a> when the related resource is deallocated.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="ResourceLeakDetector.html#track(T)">track</a></code>&nbsp;in class&nbsp;<code><a href="ResourceLeakDetector.html" title="class in io.netty.util">ResourceLeakDetector</a>&lt;<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&gt;</code></dd>
<dt>Returns:</dt>
<dd>the <a href="ResourceLeakTracker.html" title="interface in io.netty.util"><code>ResourceLeakTracker</code></a> or <code>null</code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="trackForcibly(T)">
<h3 id="trackForcibly(java.lang.Object)">trackForcibly</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public final</span>&nbsp;<span class="return-type"><a href="ResourceLeakTracker.html" title="interface in io.netty.util">ResourceLeakTracker</a>&lt;<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&gt;</span>&nbsp;<span class="element-name">trackForcibly</span><wbr><span class="parameters">(<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&nbsp;obj)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from class:&nbsp;<code><a href="ResourceLeakDetector.html#trackForcibly(T)">ResourceLeakDetector</a></code></span></div>
<div class="block">Creates a new <a href="ResourceLeakTracker.html" title="interface in io.netty.util"><code>ResourceLeakTracker</code></a> which is expected to be closed via
<a href="ResourceLeakTracker.html#close(T)"><code>ResourceLeakTracker.close(Object)</code></a> when the related resource is deallocated.
<p>
Unlike <a href="ResourceLeakDetector.html#track(T)"><code>ResourceLeakDetector.track(Object)</code></a>, this method always returns a tracker, regardless
of the detection settings.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="ResourceLeakDetector.html#trackForcibly(T)">trackForcibly</a></code>&nbsp;in class&nbsp;<code><a href="ResourceLeakDetector.html" title="class in io.netty.util">ResourceLeakDetector</a>&lt;<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&gt;</code></dd>
<dt>Returns:</dt>
<dd>the <a href="ResourceLeakTracker.html" title="interface in io.netty.util"><code>ResourceLeakTracker</code></a></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isRecordEnabled()">
<h3>isRecordEnabled</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public final</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isRecordEnabled</span>()</div>
<div class="block"><span class="description-from-type-label">Description copied from class:&nbsp;<code><a href="ResourceLeakDetector.html#isRecordEnabled()">ResourceLeakDetector</a></code></span></div>
<div class="block">Check whether <a href="ResourceLeakTracker.html#record()"><code>ResourceLeakTracker.record()</code></a> does anything for this detector.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="ResourceLeakDetector.html#isRecordEnabled()">isRecordEnabled</a></code>&nbsp;in class&nbsp;<code><a href="ResourceLeakDetector.html" title="class in io.netty.util">ResourceLeakDetector</a>&lt;<a href="#type-param-T" title="type parameter in LeakPresenceDetector">T</a>&gt;</code></dd>
<dt>Returns:</dt>
<dd><code>true</code> if <a href="ResourceLeakTracker.html#record()"><code>ResourceLeakTracker.record()</code></a> should be called</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="check()">
<h3>check</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">check</span>()</div>
<div class="block">Check the current leak presence detector scope for open resources. If any resources remain unclosed, an
exception is thrown.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/9/docs/api/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If there is a leak, or if the leak detector is not a <a href="LeakPresenceDetector.html" title="class in io.netty.util"><code>LeakPresenceDetector</code></a>.</dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2008&#x2013;2025 <a href="https://netty.io/">The Netty Project</a>. All rights reserved.</small></p>
</footer>
</main>
</div>
</body>
</html>
